<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>ğŸš– TrÆ°á»ng An Driving - Äáº·t Xe Nhanh</title>
    <meta name="theme-color" content="#006400">
    
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

    <style>
        /* --- CORE STYLES --- */
        :root {
            --primary: #006400; /* Xanh lÃ¡ Ä‘áº­m */
            --primary-light: #28a745;
            --accent: #ffc107; /* VÃ ng */
            --bg: #f4f6f8;
            --white: #ffffff;
            --text: #333;
            --radius: 12px;
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; outline: none; }
        body { margin: 0; padding: 0; font-family: 'Roboto', sans-serif; background: var(--bg); color: var(--text); padding-bottom: 40px; }

        /* HEADER */
        header {
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            color: white; padding: 15px; text-align: center;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
            position: sticky; top: 0; z-index: 1000;
        }
        .header-title { font-size: 20px; font-weight: 900; text-transform: uppercase; margin: 0; }
        .hotline-badge {
            display: inline-block; background: white; color: var(--primary);
            padding: 4px 12px; border-radius: 20px; font-weight: 700; font-size: 14px;
            margin-top: 5px; text-decoration: none; box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        /* CONTAINER */
        .container { max-width: 650px; margin: 0 auto; padding: 15px; }

        /* CARD STYLE */
        .card {
            background: white; border-radius: var(--radius); padding: 15px;
            margin-bottom: 15px; box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            border: 1px solid #eee;
        }
        .section-head {
            font-size: 15px; font-weight: 700; color: var(--primary);
            text-transform: uppercase; margin-bottom: 12px;
            display: flex; align-items: center; gap: 8px; border-bottom: 2px solid #f0f0f0; padding-bottom: 8px;
        }

        /* INPUTS */
        .input-group { margin-bottom: 12px; position: relative; }
        label { font-size: 13px; font-weight: 600; color: #555; display: block; margin-bottom: 4px; }
        
        input, select {
            width: 100%; padding: 12px 14px; padding-right: 40px;
            border: 1px solid #ddd; border-radius: 8px; font-size: 16px;
            background: #fafafa; transition: 0.3s;
        }
        input:focus, select:focus { border-color: var(--primary-light); background: #fff; box-shadow: 0 0 0 3px rgba(40, 167, 69, 0.1); }
        
        /* NÃºt X vÃ  Map trong Input */
        .input-wrapper { position: relative; }
        .tools {
            position: absolute; right: 5px; top: 50%; transform: translateY(-50%);
            display: flex; gap: 5px; align-items: center;
        }
        .btn-x {
            width: 24px; height: 24px; border-radius: 50%; background: #eee; border: none;
            color: #666; font-size: 12px; font-weight: bold; cursor: pointer;
            display: none; align-items: center; justify-content: center;
        }
        .btn-x.show { display: flex; }
        .btn-map-icon {
            background: var(--primary-light); color: white; border: none;
            padding: 5px 8px; border-radius: 6px; font-size: 12px; cursor: pointer;
        }

        /* AUTOCOMPLETE */
        .suggestions {
            position: absolute; top: 100%; left: 0; width: 100%;
            background: white; z-index: 99; border: 1px solid #ddd;
            border-radius: 0 0 8px 8px; box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            max-height: 200px; overflow-y: auto; display: none;
        }
        .suggestion-item {
            padding: 10px; border-bottom: 1px solid #f0f0f0; font-size: 14px; cursor: pointer;
            display: flex; align-items: center; gap: 8px;
        }
        .suggestion-item:hover { background: #f9f9f9; }

        /* NÃšT TÃNH GIÃ */
        .btn-calc {
            width: 100%; padding: 15px; background: linear-gradient(to right, var(--primary), var(--primary-light));
            color: white; border: none; border-radius: 12px; font-size: 18px; font-weight: 900;
            cursor: pointer; text-transform: uppercase; box-shadow: 0 4px 10px rgba(0,100,0,0.3);
            display: flex; justify-content: center; align-items: center; gap: 10px;
        }
        .btn-calc:active { transform: scale(0.98); }

        /* Káº¾T QUáº¢ */
        #result-box { display: none; animation: fadeIn 0.5s; }
        .price-big {
            font-size: 32px; font-weight: 900; color: var(--primary);
            text-align: center; margin: 5px 0; display: block;
        }
        .detail-list { list-style: none; padding: 0; margin: 10px 0; font-size: 14px; }
        .detail-list li {
            display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px dashed #eee;
        }
        .detail-list li strong { color: #333; }

        /* NÃšT ACTION */
        .actions { display: flex; gap: 10px; margin-top: 15px; }
        .btn-act {
            flex: 1; padding: 12px; border-radius: 8px; text-align: center;
            color: white; font-weight: 700; text-decoration: none; cursor: pointer; border: none;
        }
        .zalo { background: #0068ff; }
        .mail { background: #dc3545; }

        /* GHI CHÃš CHÃNH SÃCH (Theo áº£nh cÅ©) */
        .policy-box {
            font-size: 13px; color: #555; background: #fff; padding: 15px;
            border-radius: 12px; margin-top: 20px; border: 1px solid #eee;
        }
        .policy-item { display: flex; gap: 8px; margin-bottom: 8px; align-items: flex-start; }
        .policy-item i { color: #dc3545; margin-top: 3px; }

        /* MAP */
        #map { height: 300px; width: 100%; border-radius: 12px; margin-top: 15px; border: 1px solid #ccc; z-index: 1;}

        /* MODAL */
        .modal {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: white; z-index: 9999; display: none; flex-direction: column;
        }
        .modal-head { padding: 15px; background: var(--primary); color: white; display: flex; justify-content: space-between; align-items: center; }
        .modal-body { flex: 1; position: relative; }
        .center-marker { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -100%); z-index: 1000; pointer-events: none; }
        
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

<div id="kill-switch" style="display:none; position:fixed; inset:0; background:white; z-index:10000; flex-direction:column; justify-content:center; align-items:center; text-align:center;">
    <i class="fas fa-tools" style="font-size:50px; color:#ffc107;"></i>
    <h2>Há»‡ thá»‘ng Ä‘ang báº£o trÃ¬</h2>
    <a href="tel:0847526893" style="margin-top:20px; font-weight:bold; color:#006400;">LiÃªn há»‡: 084.752.6893</a>
</div>

<header>
    <div class="header-title">TRÆ¯á»œNG AN DRIVING</div>
    <a href="tel:0847526893" class="hotline-badge">â˜ï¸ 084.752.6893</a>
</header>

<div class="container">

    <div class="card">
        <div class="section-head"><i class="fas fa-user-check"></i> ThÃ´ng tin Ä‘áº·t xe</div>
        
        <div class="input-group">
            <label>Sá»‘ Ä‘iá»‡n thoáº¡i (Báº¯t buá»™c):</label>
            <div class="input-wrapper">
                <input type="tel" id="phone" placeholder="Nháº­p sá»‘ Ä‘iá»‡n thoáº¡i...">
                <div class="tools"><button class="btn-x" onclick="clearInput('phone')">âœ•</button></div>
            </div>
        </div>

        <div class="input-group">
            <label>Thá»i gian Ä‘Ã³n:</label>
            <input type="datetime-local" id="time">
        </div>
    </div>

    <div class="card">
        <div class="section-head">
            <i class="fas fa-route"></i> Lá»™ trÃ¬nh
            <span style="margin-left:auto; font-size:11px; color:#007bff; cursor:pointer;" onclick="getMyLoc()">ğŸ¯ Vá»‹ trÃ­ tÃ´i</span>
        </div>

        <div class="input-group">
            <label>Äiá»ƒm Ä‘Ã³n:</label>
            <div class="input-wrapper">
                <input type="text" id="pickup" placeholder="Nháº­p Ä‘iá»ƒm Ä‘Ã³n...">
                <div class="tools">
                    <button class="btn-x" onclick="clearInput('pickup')">âœ•</button>
                    <button class="btn-map-icon" onclick="openMap('pickup')">ğŸ—ºï¸</button>
                </div>
                <div id="sug-pickup" class="suggestions"></div>
            </div>
        </div>

        <div id="stops-container"></div>
        <div style="text-align:right; margin-bottom:10px;">
            <button onclick="addStop()" style="background:none; border:none; color:var(--primary); font-weight:bold; cursor:pointer;">
                <i class="fas fa-plus-circle"></i> ThÃªm Ä‘iá»ƒm dá»«ng
            </button>
        </div>

        <div class="input-group">
            <label>Äiá»ƒm Ä‘áº¿n:</label>
            <div class="input-wrapper">
                <input type="text" id="dropoff" placeholder="Nháº­p Ä‘iá»ƒm Ä‘áº¿n...">
                <div class="tools">
                    <button class="btn-x" onclick="clearInput('dropoff')">âœ•</button>
                    <button class="btn-map-icon" onclick="openMap('dropoff')">ğŸ—ºï¸</button>
                </div>
                <div id="sug-dropoff" class="suggestions"></div>
            </div>
        </div>
    </div>

    <div class="card">
        <div class="section-head"><i class="fas fa-car-side"></i> TÃ¹y chá»n xe</div>
        
        <div class="input-group">
            <label>Loáº¡i xe:</label>
            <select id="carType">
                <option value="4">ğŸš— Xe 4 chá»— (10.000Ä‘/km)</option>
                <option value="7">ğŸš Xe 7 chá»— (12.000Ä‘/km)</option>
            </select>
        </div>

        <div class="input-group">
            <label>HÃ¬nh thá»©c Ä‘i:</label>
            <select id="tripType" onchange="toggleWait()">
                <option value="1">â¡ï¸ Äi 1 Chiá»u</option>
                <option value="2">ğŸ”„ Äi 2 Chiá»u (Giáº£m 40% chiá»u vá»)</option>
            </select>
        </div>

        <div id="wait-area" style="display:none; background:#f0f9f0; padding:10px; border-radius:8px; margin-bottom:10px;">
            <label>â³ Thá»i gian chá» (Miá»…n phÃ­ 3h Ä‘áº§u):</label>
            <input type="number" id="waitHour" placeholder="Nháº­p sá»‘ giá» chá»..." value="0">
            <small style="color:#666; font-size:11px;">Sau 3h, phá»¥ phÃ­ 50.000Ä‘/giá»</small>
        </div>

        <div class="input-group">
            <label>Chá»n tÃ i xáº¿:</label>
            <select id="driver">
                <option value="Há»‡ thá»‘ng">â­ Há»‡ thá»‘ng TrÆ°á»ng An (Nhanh nháº¥t)</option>
                <option value="Thanh Loan">ğŸ‘©â€ğŸ¦° Thanh Loan</option>
                <option value="ÄÃ¬nh TÃ¢m">ğŸ‘¨â€âœˆï¸ ÄÃ¬nh TÃ¢m</option>
            </select>
        </div>
    </div>

    <button class="btn-calc" id="btn-cal" onclick="calcPrice()">
        <i class="fas fa-calculator"></i> TÃNH GIÃ CÆ¯á»šC
    </button>

    <div id="map"></div>

    <div id="result-box" class="card" style="margin-top:15px; border:2px solid var(--primary-light);">
        <div style="text-align:center; font-size:14px; color:#555;">ğŸ’° GiÃ¡ dá»± kiáº¿n</div>
        <span class="price-big" id="res-total">0 Ä‘</span>
        
        <ul class="detail-list">
            <li><span>âœï¸ QuÃ£ng Ä‘Æ°á»ng:</span> <strong id="res-km">0 km</strong></li>
            <li><span>â± Thá»i gian cháº¡y:</span> <strong id="res-time">0 phÃºt</strong></li>
            
            <li id="row-go" style="color:#555;"><span>Chiá»u Ä‘i:</span> <strong id="val-go">0 Ä‘</strong></li>
            <li id="row-back" style="display:none; color:var(--primary);"><span>Chiá»u vá» (-40%):</span> <strong id="val-back">0 Ä‘</strong></li>
            <li id="row-wait-fee" style="display:none;"><span>PhÃ­ chá»:</span> <strong id="val-wait">0 Ä‘</strong></li>
            
            <li id="row-deposit" style="display:none; background:#fff3cd; padding:5px; margin-top:5px; border-radius:5px;">
                <span style="font-weight:bold; color:#856404;">ğŸ’³ Cáº§n Ä‘áº·t cá»c (20%):</span> 
                <strong style="color:#d32f2f;" id="val-deposit">0 Ä‘</strong>
            </li>
        </ul>

        <div class="actions">
            <button class="btn-act zalo" onclick="book('zalo')"><i class="fas fa-comment"></i> Äáº·t qua Zalo</button>
            <button class="btn-act mail" onclick="book('mail')"><i class="fas fa-envelope"></i> Gá»­i Mail</button>
        </div>
    </div>

    <div class="policy-box">
        <h4 style="margin:0 0 10px 0; font-size:14px; text-transform:uppercase;">ğŸ“ Ghi chÃº quan trá»ng:</h4>
        <div class="policy-item"><i class="fas fa-thumbtack"></i> <span>GiÃ¡ 4 chá»—: 10k/km | 7 chá»—: 12k/km.</span></div>
        <div class="policy-item"><i class="fas fa-thumbtack"></i> <span>Äi 2 chiá»u (Tá»•ng > 90km) giáº£m 40% chiá»u vá».</span></div>
        <div class="policy-item"><i class="fas fa-clock"></i> <span><strong>Thá»i gian chá»:</strong> Miá»…n phÃ­ 0-3 giá» Ä‘áº§u. Tá»« giá» thá»© 4 thu 50.000Ä‘/giá».</span></div>
        <div class="policy-item"><i class="fas fa-exclamation-circle"></i> <span>GiÃ¡ chÆ°a bao gá»“m phÃ­ cáº§u Ä‘Æ°á»ng, báº¿n bÃ£i.</span></div>
    </div>
</div>

<div id="modal-map" class="modal">
    <div class="modal-head">
        <span>Chá»n vá»‹ trÃ­</span>
        <button onclick="closeMap()" style="background:none; border:none; color:white; font-size:24px;">&times;</button>
    </div>
    <div class="modal-body">
        <div id="picker-map" style="width:100%; height:100%;"></div>
        <img src="https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon.png" class="center-marker">
    </div>
    <div style="padding:15px; text-align:center; background:white;">
        <p style="margin:0 0 10px; font-size:12px; color:#666;">Di chuyá»ƒn báº£n Ä‘á»“ Ä‘á»ƒ ghim vá»‹ trÃ­</p>
        <button onclick="confirmLoc()" style="width:100%; padding:12px; background:var(--primary); color:white; border:none; border-radius:8px; font-weight:bold;">XÃC NHáº¬N</button>
    </div>
</div>

<script>
    // --- Cáº¤U HÃŒNH ---
    const P4 = 10000, P7 = 12000, WAIT_FEE = 50000;
    let map, routeL, pickerMap, activeInp;
    let stopCount = 0;

    // --- KHá»I Táº O ---
    window.onload = () => {
        // Kill Switch Logic (Sá»­a false thÃ nh true Ä‘á»ƒ báº£o trÃ¬)
        if(false) document.getElementById('kill-switch').style.display = 'flex';

        // Map chÃ­nh
        map = L.map('map').setView([10.7769, 106.7009], 13);
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);

        // Set time
        let now = new Date(); now.setMinutes(now.getMinutes()+30-now.getTimezoneOffset());
        document.getElementById('time').value = now.toISOString().slice(0,16);

        // Input Logic
        setupInputs();
    };

    // --- INPUT Xá»¬ LÃ ---
    function setupInputs(){
        ['phone','pickup','dropoff'].forEach(id => {
            let el = document.getElementById(id);
            el.addEventListener('input', function(){
                toggleX(this);
                if(id!='phone') searchAddr(this);
            });
            el.addEventListener('focus', ()=> toggleX(el));
        });
    }

    function toggleX(inp) {
        let btn = inp.parentElement.querySelector('.btn-x');
        if(btn) btn.style.display = inp.value ? 'flex' : 'none';
    }

    function clearInput(id) {
        let inp = document.getElementById(id);
        inp.value = ''; delete inp.dataset.lat; delete inp.dataset.lon;
        toggleX(inp); inp.focus();
    }

    // --- TÃŒM Äá»ŠA CHá»ˆ (NOMINATIM) ---
    let timer;
    function searchAddr(inp) {
        clearTimeout(timer);
        let list = inp.parentElement.querySelector('.suggestions');
        if(inp.value.length < 3) { list.style.display='none'; return; }
        
        timer = setTimeout(() => {
            fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(inp.value)}&countrycodes=vn&limit=5`)
            .then(r=>r.json()).then(d => {
                list.innerHTML = '';
                if(!d.length) { list.style.display='none'; return; }
                d.forEach(i => {
                    let div = document.createElement('div');
                    div.className = 'suggestion-item';
                    div.innerHTML = `ğŸ“ ${i.display_name.split(',')[0]}`;
                    div.onclick = () => {
                        inp.value = i.display_name;
                        inp.dataset.lat = i.lat; inp.dataset.lon = i.lon;
                        list.style.display='none'; toggleX(inp);
                    };
                    list.appendChild(div);
                });
                list.style.display='block';
            });
        }, 500);
    }
    document.addEventListener('click', e => {
        if(!e.target.closest('.input-wrapper')) document.querySelectorAll('.suggestions').forEach(s=>s.style.display='none');
    });

    // --- ÄIá»‚M Dá»ªNG ---
    function addStop(){
        stopCount++; let id = `stop-${stopCount}`;
        let d = document.createElement('div'); d.className='input-group';
        d.innerHTML = `<div class="input-wrapper">
            <input type="text" id="${id}" placeholder="Äiá»ƒm dá»«ng ${stopCount}..." oninput="toggleX(this); searchAddr(this)">
            <div class="tools"><button class="btn-x" onclick="this.parentElement.parentElement.parentElement.remove()">âœ•</button></div>
            <div class="suggestions"></div></div>`;
        document.getElementById('stops-container').appendChild(d);
    }

    // --- Báº¢N Äá»’ PICKER ---
    function openMap(id) {
        activeInp = id; document.getElementById('modal-map').style.display='flex';
        if(!pickerMap) {
            pickerMap = L.map('picker-map').setView([10.7769, 106.7009], 15);
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(pickerMap);
        }
        setTimeout(()=>pickerMap.invalidateSize(), 200);
        // Äá»‹nh vá»‹
        if(navigator.geolocation) navigator.geolocation.getCurrentPosition(p=>{
            pickerMap.setView([p.coords.latitude, p.coords.longitude], 15);
        });
    }
    function closeMap(){ document.getElementById('modal-map').style.display='none'; }
    function confirmLoc(){
        let c = pickerMap.getCenter();
        let inp = document.getElementById(activeInp);
        inp.dataset.lat = c.lat; inp.dataset.lon = c.lng;
        inp.value = `${c.lat.toFixed(5)}, ${c.lng.toFixed(5)}`;
        // Láº¥y tÃªn
        fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${c.lat}&lon=${c.lng}`)
        .then(r=>r.json()).then(d=>{ if(d.display_name) inp.value=d.display_name; });
        closeMap(); toggleX(inp);
    }
    function getMyLoc(){
        if(!navigator.geolocation) return alert('KhÃ´ng cÃ³ quyá»n GPS');
        navigator.geolocation.getCurrentPosition(p=>{
            let inp = document.getElementById('pickup');
            inp.dataset.lat = p.coords.latitude; inp.dataset.lon = p.coords.longitude;
            inp.value = "Vá»‹ trÃ­ cá»§a tÃ´i";
            fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${p.coords.latitude}&lon=${p.coords.longitude}`)
            .then(r=>r.json()).then(d=>{ if(d.display_name) inp.value=d.display_name; });
        });
    }

    // --- TÃNH GIÃ ---
    function toggleWait(){
        document.getElementById('wait-area').style.display = document.getElementById('tripType').value=='2'?'block':'none';
    }

    async function calcPrice() {
        let p = document.getElementById('pickup'), d = document.getElementById('dropoff');
        if(!p.dataset.lat || !d.dataset.lat) return alert('Vui lÃ²ng chá»n Ä‘á»‹a chá»‰ tá»« gá»£i Ã½ hoáº·c báº£n Ä‘á»“!');
        
        let btn = document.getElementById('btn-cal'); btn.innerHTML = 'â³ Äang tÃ­nh...'; btn.disabled=true;
        
        // Build coords
        let points = [p, ...document.querySelectorAll('#stops-container input'), d];
        let coordStr = points.map(i => `${i.dataset.lon},${i.dataset.lat}`).join(';');

        try {
            let res = await fetch(`https://router.project-osrm.org/route/v1/driving/${coordStr}?overview=full&geometries=geojson`);
            let data = await res.json();
            if(data.code!='Ok') throw 'Err';

            let r = data.routes[0];
            let dist = r.distance/1000;
            let time = Math.round(r.duration/60);

            // Draw
            if(routeL) map.removeLayer(routeL);
            routeL = L.geoJSON(r.geometry).addTo(map);
            map.fitBounds(routeL.getBounds(), {padding:[50,50]});

            // Calc
            let car = document.getElementById('carType').value;
            let trip = document.getElementById('tripType').value;
            let priceKm = car=='4'?P4:P7;
            
            let goPrice = Math.round(dist * priceKm);
            let backPrice = 0, waitCost = 0;
            
            if(trip == '2') {
                backPrice = (dist >= 45) ? Math.round(goPrice * 0.6) : goPrice;
                let waitH = parseFloat(document.getElementById('waitHour').value) || 0;
                if(waitH > 3) waitCost = (waitH - 3) * WAIT_FEE;
            }

            let total = goPrice + backPrice + waitCost;
            let deposit = (trip == '2') ? Math.round(total * 0.2) : 0;

            // Display
            document.getElementById('result-box').style.display='block';
            document.getElementById('res-total').innerText = total.toLocaleString() + ' Ä‘';
            document.getElementById('res-km').innerText = dist.toFixed(1) + ' km';
            document.getElementById('res-time').innerText = time + ' phÃºt';
            
            document.getElementById('val-go').innerText = goPrice.toLocaleString() + ' Ä‘';
            
            let rowBack = document.getElementById('row-back');
            if(trip=='2'){
                rowBack.style.display='flex';
                rowBack.querySelector('strong').innerText = backPrice.toLocaleString() + ' Ä‘';
            } else rowBack.style.display='none';

            let rowWait = document.getElementById('row-wait-fee');
            if(waitCost>0){
                rowWait.style.display='flex';
                document.getElementById('val-wait').innerText = waitCost.toLocaleString() + ' Ä‘';
            } else rowWait.style.display='none';

            let rowDep = document.getElementById('row-deposit');
            if(deposit>0){
                rowDep.style.display='flex';
                document.getElementById('val-deposit').innerText = deposit.toLocaleString() + ' Ä‘';
            } else rowDep.style.display='none';

            document.getElementById('result-box').scrollIntoView({behavior:'smooth'});

        } catch(e) { alert('KhÃ´ng tÃ¬m tháº¥y Ä‘Æ°á»ng!'); }
        btn.innerHTML = 'ğŸ’° TÃNH GIÃ CÆ¯á»šC'; btn.disabled=false;
    }

    // --- BOOKING ---
    function book(method) {
        let phone = document.getElementById('phone').value;
        if(!phone) return alert('Vui lÃ²ng nháº­p Sá»‘ Ä‘iá»‡n thoáº¡i Ä‘á»ƒ chÃºng tÃ´i liÃªn há»‡!');

        let info = {
            from: document.getElementById('pickup').value,
            to: document.getElementById('dropoff').value,
            car: document.getElementById('carType').selectedOptions[0].text,
            type: document.getElementById('tripType').selectedOptions[0].text,
            total: document.getElementById('res-total').innerText,
            deposit: document.getElementById('val-deposit').innerText
        };

        let msg = `ğŸš– TRÆ¯á»œNG AN DRIVING\n-----------------\nğŸ“± KhÃ¡ch: ${phone}\nğŸ•’ ÄÃ³n: ${document.getElementById('time').value.replace('T',' ')}\nğŸ“ Äi: ${info.from}\nğŸ Äáº¿n: ${info.to}\nğŸš˜ Xe: ${info.car}\nğŸ”„ Loáº¡i: ${info.type}\nğŸ’° Tá»”NG: ${info.total}`;
        
        if(document.getElementById('tripType').value=='2') msg += `\nğŸ’³ Äáº·t cá»c (20%): ${info.deposit}`;

        if(method=='zalo') {
            navigator.clipboard.writeText(msg);
            alert('ÄÃ£ copy Ä‘Æ¡n! Má»Ÿ Zalo...');
            window.open('https://zalo.me/0847526893');
        } else {
            window.location.href = `mailto:truongan.driving@gmail.com?subject=Äáº¶T XE&body=${encodeURIComponent(msg)}`;
        }
    }
</script>

</body>
</html>
